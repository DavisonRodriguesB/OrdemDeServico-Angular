<div class="p-8 bg-slate-50 min-h-screen font-sans text-sm print:bg-white print:p-0">
  
  <div class="w-full bg-white rounded-xl shadow-sm p-8 border border-gray-300">
    
    <div class="flex justify-between items-start mb-8 border-b border-gray-100 pb-6">
      <div>
        <h1 class="text-2xl font-bold text-gray-800 tracking-tight">Relatórios de Produtividade</h1>
        <p class="text-gray-500 text-base">Análise consolidada de performance, faturamento e execução.</p>
      </div>

      <div class="flex gap-2 print:hidden">
        <button (click)="printReport()" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 flex items-center gap-2 font-semibold transition-all">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6.72 13.89l-4.72-4.72m0 0l4.72-4.72M2 9.17h18a2.25 2.25 0 012.25 2.25v6.75a2.25 2.25 0 01-2.25 2.25H6.75a2.25 2.25 0 01-2.25-2.25v-4.5" />
          </svg>
          Imprimir
        </button>
        <button (click)="exportReport('csv')" class="px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 flex items-center gap-2 font-semibold transition-all">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" />
          </svg>
          Exportar CSV
        </button>
      </div>
    </div>

    <div class="flex gap-4 mb-10 print:hidden">
        <div class="flex-1 max-w-xs">
            <label class="block text-xs font-semibold text-gray-600 uppercase mb-1">Período</label>
            <select [(ngModel)]="periodoSelecionado" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none">
                <option>Últimos 7 dias</option>
                <option>Últimos 30 dias</option>
                <option>Este Mês</option>
                <option>Personalizado</option>
            </select>
        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-10">
      <div class="p-6 bg-slate-50 border border-gray-300 rounded-lg">
        <p class="text-[10px] text-gray-600 font-black uppercase tracking-widest mb-1">Total Faturado</p>
        <p class="text-1xl font-black text-emerald-600">{{ reportData.metrics.totalFaturado | currency:'BRL' }}</p>
      </div>
      <div class="p-6 bg-slate-50 border border-gray-300 rounded-lg">
        <p class="text-[10px] text-gray-600 font-black uppercase tracking-widest mb-1">Ticket Médio por OS</p>
        <p class="text-1xl font-black text-blue-600">{{ reportData.metrics.ticketMedio | currency:'BRL' }}</p>
      </div>
      <div class="p-6 bg-slate-50 border border-gray-300 rounded-lg">
        <p class="text-[10px] text-gray-600 font-black uppercase tracking-widest mb-1">Tempo Médio Global</p>
        <p class="text-1xl font-black text-gray-700">{{ reportData.metrics.tempoMedioGlobal }}</p>
      </div>
      <div class="p-6 bg-slate-50 border border-gray-300 rounded-lg">
        <p class="text-[10px] text-gray-600 font-black uppercase tracking-widest mb-1">Taxa de Conclusão</p>
        <p class="text-1xl font-black text-orange-600">{{ reportData.metrics.taxaSucesso }}%</p>
      </div>
    </div>

    <div class="mb-10">
      <h3 class="text-base font-bold text-gray-700 mb-4 uppercase tracking-tight">Produtividade Detalhada por Equipe</h3>
      <div class="overflow-x-auto rounded-lg border border-gray-300 shadow-sm">
        <table class="w-full text-sm">
          <thead class="bg-gray-50 text-gray-600 border-b border-gray-300">
            <tr>
              <th class="h-12 px-6 text-left font-medium">Equipe</th>
              <th class="h-12 px-6 text-center font-medium">OS Concluídas</th>
              <th class="h-12 px-6 text-center font-medium">Tempo Médio</th>
              <th class="h-12 px-6 text-right font-medium">Faturamento</th>
              <th class="h-12 px-6 text-center font-medium">Performance (%)</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of reportData.produtividadeEquipes" class="border-b border-gray-200 hover:bg-slate-50 transition-colors">
              <td class="p-4 px-6 font-bold text-gray-800">{{ item.equipe }}</td>
              <td class="p-4 px-6 text-center text-gray-600">{{ item.concluidas }}</td>
              <td class="p-4 px-6 text-center font-mono text-gray-500">{{ item.tempoMedio }}</td>
              <td class="p-4 px-6 text-right font-bold text-emerald-600">{{ item.faturamento | currency:'BRL' }}</td>
              <td class="p-4 px-6">
                <div class="flex items-center justify-center gap-3">
                  <div class="w-24 bg-gray-200 rounded-full h-2">
                    <div class="bg-blue-600 h-2 rounded-full" [style.width.%]="item.performance"></div>
                  </div>
                  <span class="text-xs font-bold text-gray-700">{{ item.performance }}%</span>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <div class="p-6 border border-gray-300 rounded-xl">
            <h3 class="text-base font-bold text-gray-700 mb-4">Volume e Receita por Tipo</h3>
            <div class="space-y-4">
                <div *ngFor="let tipo of reportData.servicosPorTipo" class="flex items-center justify-between p-4 bg-slate-50 border border-gray-100 rounded-lg">
                    <div>
                        <span class="text-xs font-black text-blue-600 uppercase tracking-tighter">{{ tipo.tipo }}</span>
                        <p class="text-sm font-bold text-gray-800">{{ tipo.quantidade }} Ordens</p>
                    </div>
                    <div class="text-right">
                        <p class="text-xs text-gray-600 uppercase font-bold">Total Faturado</p>
                        <p class="text-md font-black text-gray-700">{{ tipo.faturado | currency:'BRL' }}</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="p-6 border border-gray-300 rounded-xl bg-slate-900 text-white">
            <h3 class="text-base font-bold mb-6">Insights da Operação</h3>
            <ul class="space-y-4">
                <li class="flex gap-3 items-start">
                    <span class="text-emerald-400 font-bold">✓</span>
                    <p class="text-sm text-slate-300">A <strong>Equipe Comercial 01</strong> superou a meta de produtividade em 8% este mês.</p>
                </li>
                <li class="flex gap-3 items-start">
                    <span class="text-orange-400 font-bold">!</span>
                    <p class="text-sm text-slate-300">Serviços de <strong>Obras</strong> representam 60% do faturamento, mas apenas 15% do volume de OS.</p>
                </li>
                <li class="flex gap-3 items-start">
                    <span class="text-blue-400 font-bold">ℹ</span>
                    <p class="text-sm text-slate-300">Tempo médio de execução reduziu 12 minutos após nova lógica de roteirização.</p>
                </li>
            </ul>
            <div class="mt-8 pt-6 border-t border-slate-700">
                <p class="text-[10px] text-slate-500 uppercase font-bold tracking-widest">Recomendação</p>
                <p class="text-sm text-slate-400 mt-2">"Considerar alocação de mais recursos para Manutenção para reduzir o tempo médio global."</p>
            </div>
        </div>
    </div>

  </div>
</div>